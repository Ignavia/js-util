<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../">
  <title data-ice="title">src/EventManager.js | JavaScript Utility API Document</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  
  
  <script src="script/manual.js"></script>
</head>
<body class="layout-container" data-ice="rootContainer">

<header>
  <a href="./">Home</a>
  <a href="./manual/index.html" data-ice="manualHeaderLink">Manual</a>
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  
  <a data-ice="repoURL" href="https://github.com/Ignavia/js-util.git" class="repo-url-github">Repository</a>
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
</header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  <li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/Cloner.js~Cloner.html">Cloner</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/Color.js~Color.html">Color</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/Event.js~Event.html">Event</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/EventManager.js~EventManager.html">EventManager</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/IDGenerator.js~IDGenerator.html">IDGenerator</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/Plugin.js~Plugin.html">Plugin</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-cloneableExtendedMixin">cloneableExtendedMixin</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-cloneableMixin">cloneableMixin</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-cloneableSymbols">cloneableSymbols</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-predefinedColors">predefinedColors</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-extensibleExtendedMixin">extensibleExtendedMixin</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-extensibleMixin">extensibleMixin</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-extensibleSymbols">extensibleSymbols</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-observableExtendedMixin">observableExtendedMixin</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-observableMixin">observableMixin</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-observableSymbols">observableSymbols</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">gump</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/gump/GumpMap.js~GumpMap.html">GumpMap</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/gump/GumpPath.js~GumpPath.html">GumpPath</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/gump/GumpSet.js~GumpSet.html">GumpSet</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">tolkien</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/tolkien/Tolkien1To1Map.js~Tolkien1To1Map.html">Tolkien1To1Map</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/tolkien/Tolkien1ToNMap.js~Tolkien1ToNMap.html">Tolkien1ToNMap</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/tolkien/TolkienMToNMap.js~TolkienMToNMap.html">TolkienMToNMap</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/tolkien/TolkienMap.js~TolkienMap.html">TolkienMap</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-compose">compose</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">tortilla</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/tortilla/TortillaGeneratorFunction.js~TortillaGeneratorFunction.html">TortillaGeneratorFunction</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/tortilla/TortillaIterable.js~TortillaIterable.html">TortillaIterable</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/tortilla/TortillaIterator.js~TortillaIterator.html">TortillaIterator</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/tortilla/TortillaWrapper.js~TortillaWrapper.html">TortillaWrapper</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-tortilla">tortilla</a></span></span></li>
</ul>
</div>
</nav>

<div class="content" data-ice="content"><h1 data-ice="title">src/EventManager.js</h1>
<pre class="source-code line-number raw-source-code"><code class="prettyprint linenums" data-ice="content">import Event               from &quot;./Event.js&quot;;
import {observableSymbols} from &quot;./Observable.js&quot;;

/**
 * A helper class that can manage events and event listeners for other objects.
 * If you want to hide that you are using this class, you can use the provided
 * {@link observableMixin}.
 *
 * @implements {Observable}
 */
export default class EventManager {

    /**
     * A factory method for {@link Event} objects.
     *
     * @param {Object} p
     * The parameter object.
     *
     * @param {Object} [p.source]
     * The object firing this event.
     *
     * @param {String} [p.type]
     * The type of this event.
     *
     * @param {*} [p.data]
     * Any additional data to associate with this event.
     *
     * @return {Event}
     * The new Event object.
     */
    static makeEvent({source, type, data} = {}) {
        return new Event({source, type, data});
    }

    /**
     *
     */
    constructor() {

        /**
         * Maps from an event type to its listeners.
         *
         * @type {Map&lt;String, Set&lt;Function&gt;&gt;}
         */
        this.typeToListeners = new Map();

        /**
         * Maps from a listener to the types of events it listens to.
         *
         * @type {Map&lt;Function, Set&lt;String&gt;}
         */
        this.listenerToTypes = new Map();
    }

    /**
     * Adds an event listener to this event manager.
     *
     * @param {Function} f
     * The function that should be executed when the event fires.
     *
     * @param {String|Iterator&lt;String&gt;} [types]
     * The types of events the function should listen to. If this parameter is
     * not specified it will only listen to events without a type.
     *
     * @return {EventManager}
     * This event manager to make the method chainable.
     */
    [observableSymbols.addListener](f, types = []) {
        if (typeof types === &quot;string&quot;) {
            types = [types];
        }

        if (!this.listenerToTypes.has(f)) {
            this.listenerToTypes.set(f, new Set());
        }
        for (let type of types) {
            if (!this.typeToListeners.has(type)) {
                this.typeToListeners.set(type, new Set());
            }
            this.typeToListeners.get(type).add(f);
            this.listenerToTypes.get(f).add(type);
        }

        return this;
    }

    /**
     * Removes an event listener from this event manager.
     *
     * @param {Function} f
     * The listener that should be removed.
     *
     * @param {String|Iterator&lt;String&gt;} [types]
     * The types of events the function should no longer listen to. If this
     * parameter is left empty the listener is removed completely.
     *
     * @return {EventManager}
     * This event manager to make the method chainable.
     */
    [observableSymbols.removeListener](f, types = this.listenerToTypes.get(f)) {
        if (types === undefined) {
            return this;
        } else if (typeof types === &quot;string&quot;) {
            types = [types];
        }

        for (let type of types) {
            if (!this.typeToListeners.has(type)) {
                continue;
            }

            this.typeToListeners.get(type).delete(f);
            if (this.typeToListeners.get(type).size === 0) {
                this.typeToListeners.delete(type);
            }
            this.listenerToTypes.get(f).delete(type);
        }

        if (this.listenerToTypes.get(f).size === 0) {
            this.listenerToTypes.delete(f);
        }

        return this;
    }

    /**
     * Notifies all listeners that are interested in the given event.
     *
     * @param {Event} e
     * The event to fire.
     *
     * @return {EventManager}
     * This event manager to make the method chainable.
     */
    [observableSymbols.fireEvent](e) {
        let listeners;
        if (e.type) {
            listeners = this.typeToListeners.get(e.type) || [];
        } else {
            listeners = this.listenerToTypes.keys();
        }
        for (let f of listeners) {
            f(e);
        }
        return this;
    }
}
</code></pre>

</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(0.4.7)</span></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
